<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->

<!-- templatemo 417 grill -->
<!-- 
Grill Template 
http://www.templatemo.com/preview/templatemo_417_grill 
-->
    <head>
        <meta charset="utf-8">
        <title>Spaceaid</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="css/bootstrap.css">
        <link rel="stylesheet" href="css/font-awesome.css">
        <link rel="stylesheet" href="css/templatemo_style.css">
        <link rel="stylesheet" href="css/templatemo_misc.css">
        <link rel="stylesheet" href="css/flexslider.css">
        <link rel="stylesheet" href="css/testimonails-slider.css">
		<link  href="css/menu.css" rel="stylesheet">
		
		<style>
		
		.not-visible{
			display:none;
		}
		
		.visible{
			display:block;
		}
		
		#forecast-temperature-summary
		{
		  
			display:inline-block;
			font-size:22px;
			font-family: 'Unlock';
			font-weight:bold;
			padding-top:10px;
		}
			/*.forecast {
				display: none;
			} */
			
			#weather-alert {
				width: 100%;
				height: 20px;
				background: red;
				display: none;
			}
			
			.forecast #forecast-header,
			.forecast .forecast-title {
				text-align: center;
				font-weight: bold;
			}
			
			#forecast-icon,#forecast-temperature-summary
			{
				
				height:50px;
			}
			
			<!-- Add these! -->
			.forecast .clear-day {
				background-image: url('images/clear-day.png') center no-repeat;
				background-position: center; 
			}
			
			.forecast .clear-night {
				background: url('images/clear-night.png') center no-repeat;
				
			}
			
			.forecast .rain {
				background: url('images/rain.png') center no-repeat ;
				
			
			}
			
			.forecast .snow {
				background: url('images/snow.png') center no-repeat;
				
			}
			
			.forecast .sleet {
				background: url('images/sleet.png') center no-repeat;
				
			}
			
			.forecast .wind {
				background: url('images/wind.png') center no-repeat;
				
			}
			
			.forecast .fog {
				background: url('images/fog.png') center no-repeat;
				 
			}
			
			.forecast .cloudy {
				background: url('images/cloudy.png') center no-repeat;
				 
			}
			
			.forecast .partly-cloudy-day {
				background: url('images/partly-cloudy-day.png') center no-repeat;
				
			}
			
			.forecast .partly-cloudy-night {
				background: url('images/partly-cloudy-night.png') center no-repeat;
				
			}
			
			
			/*
			.forecast div {
				text-align: left;
			} */
		</style>

        <script src="js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>
        <script src="js/vendor/d3.js"></script>
        <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
        <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.js'></script>
        <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.css' rel='stylesheet' />
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->
		<div id="weather-alert"></div>
        <header>	
		<div class="container">
				<div class="navbar navbar-static-top">
					<div class="navigation">
						<nav>
						<ul class="nav topnav bold">
							<li class="dropdown active">
							<a href="#">Home </a>
							</li>
							<li class="dropdown">
							<a href="#">Visualizations <i class="icon-angle-down"></i></a>
							<ul style="display: none;" class="dropdown-menu bold">
								<li><a href="Views/varna-floods.html">Varna</a></li>
								<li><a href="Views/dobrich-floods.html">Dobrich</a></li>
							</ul>
							</li>

							
							<li class="dropdown">
							<a href="http://spaceaidproject.eu/blog/">Blog </a>
						
							</li>
							<li>
							<a href="#">About us </a>
							</li>
						</ul>
						</nav>
					</div>
					
					<!-- end navigation -->
				</div>
			</div>
			
	</header>
			
            <div id="services">
                <div class="container">
                  
					<!-- #startregion forecast -->
					<div class="row forecast">
                        <div class="col-md-12">
                            <div class="heading-section">
                                <h2 id="forecast-header">The weather</h2>
								<img src="images/under-heading.png" alt="" >
                            </div>
                        </div>
                    </div>
                    				<!--  <div id="warning-panel" class="row not-visible">
                        <div class="col-md-12">
                            <div class="heading-section">-->
							
									<div id="success-panel" class="alert alert-success alert-dismissible not-visible" role="alert">	
									  <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
									  <strong>Warning! </strong><div id="warning-text" style="display:inline-block"> </div>
									</div>
									<div id="warning-panel2" class="alert alert-warning alert-dismissible not-visible" role="alert">	
									  <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
									  <strong>Warning! </strong>It's hot out there. Get a hat for the sun!</div>
                               		<div id="warning-panel1" class="alert alert-warning alert-dismissible not-visible" role="alert">	
									  <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
									  <strong>Warning! </strong>It's cold out there. Put on warm clothes!</div>
									
									
			
									<div id="danger-panel1" class="alert alert-danger alert-dismissible not-visible" role="alert">	
									  <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
									  <strong>Warning! </strong>It's very cold out there. There might be frozen areas. Put on warm clothes!</div>
									
									<div id="danger-panel2" class="alert alert-danger alert-dismissible not-visible" role="alert">	
									  <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
									  <strong>Warning! </strong>It's raining out there. Get an umbrella! </div>
									  
									<div id="danger-panel3" class="alert alert-danger alert-dismissible not-visible" role="alert">	
									  <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
									  <strong>Danger! </strong>There's a serious rainstorm and gusts of wind!</div>
									  
									<div id="danger-panel4" class="alert alert-danger alert-dismissible not-visible" role="alert">	
									  <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
									  <strong>Danger! </strong>Possible flooding in your area! Seek shelter!</div>
									
                           <!-- </div>
                        </div>
                    </div>-->
					<div class="row forecast" id="forecast-now">
                        <div class="col-md-3 col-sm-6">
							<div class="service-item">
								<div class="forecast-title bg-info">Right now</div>
								<div id="forecast-icon" ></div>
								<div id="forecast-temperature-celsius"><i>Temperature</i> : </div>
								<div id="forecast-temperature-feel"><i>Feels like</i> : </div>
								<div id="forecast-temperature-summary"></div>
							</div>
                        </div>
						<div class="col-md-3 col-sm-6">
							<div class="service-item">
								<div class="forecast-title bg-info">More info</div>
								<div id="forecast-rain"><i>Probable rain volume</i> : </div>
								<div id="forecast-humidity"><i>Humidity</i> : </div>
								<div id="forecast-dew"><i>Dew point</i> : </div>
								<div id="forecast-wind"><i>Wind speed</i> : </div>
								<div id="forecast-pressure"><i>Pressure</i> : </div>
							</div>
                        </div>
						<div class="col-md-3 col-sm-6">
							<div class="service-item">
								<div class="forecast-title bg-info">Next hour</div>
								<div id="forecast-hour"></div>
							</div>
                        </div>
						<div class="col-md-3 col-sm-6">
							<div class="service-item">
								<div class="forecast-title bg-info">Next week</div>
								<div id="forecast-week"></div>
							</div>
                        </div>
                    </div>					
				</div>
			</div>
		
				

            <div id="latest-blog">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="heading-section">
                                <h2>Flood visualizations</h2>
                                <img src="images/under-heading.png" alt="" >
                            </div>
                        </div>
                    </div>
						
						<div class="row">
                        <div class="col-md-4 col-sm-6">
                            <div class="blog-post">
                                <div class="blog-thumb">
                                    <img src="images/varna1.png" alt="" />
                                </div>
                                <div class="blog-content">
                                    <div class="content-show">
                                        <h4><a href="Views/varna-floods.html">Get a closer look at the Varna flooding</a></h4>
                                        <span></span>
                                    </div>
                                    <div class="content-hide">
                                        <p>Detailed map views on terrain,flooded areas and objects</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-6">
                            <div class="blog-post">
                                <div class="blog-thumb">
                                    <img src="images/dobrich.png" alt="" />
                                </div>
                                <div class="blog-content">
                                    <div class="content-show">
                                        <h4><a href="Views/dobrich-floods.html">Get a closer look at the Dobrich flooding</a></h4>
                                        <span></span>
                                    </div>
                                    <div class="content-hide">
                                        <p>Detailed map views on terrain,flooded areas and objects</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
			

            <div id="testimonails">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="heading-section">
                                <h2>Future development</h2>
                                <img src="images/under-heading.png" alt="" >
                            </div>
                        </div>
                    </div>
                   	<div class="row">
                        <div class="col-md-4 col-sm-6">
                            <div class="blog-post">
                                <div class="blog-thumb">
                                    <img src="images/android.png" alt="" />
                                </div>
                                <div class="blog-content">
                                    <div class="content-show">
                                        <h4>Android application</h4>
                                        <span></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-6">
                            <div class="blog-post">
                                <div class="blog-thumb">
                                    <img src="images/ios.png" alt="" />
                                </div>
                                <div class="blog-content">
                                    <div class="content-show">
                                        <h4>IOS Application</h4>
                                        <span></span>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-6">
                            <div class="blog-post">
                                <div class="blog-thumb">
                                    <img src="images/wp.png" alt="" />
                                </div>
                                <div class="blog-content">
                                    <div class="content-show">
                                        <h4>Windows Phone Application</h4>
                                        <span></span>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

			<footer>
                <div class="container">
                 
                    <div class="bottom-footer">
                        <p>Copyright © 2014 <a href="#">Spaceaid team</a> </p>
                    </div>
                    
                </div>
            </footer>
   
       

	
        <script src="js/vendor/jquery-1.11.0.min.js"></script>
        <script src="js/vendor/jquery.gmap3.min.js"></script>
		<script src="js/bootstrap.js"></script>
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>
		<script src="js/menu.js"></script>
		<script>
			var forecastUrl = "http://forecastapi.apphb.com/api/forecast?";
			var temperatureInCelsius= 0;
			var summary ="";
			
			var isVeryCold = false;
			
			function getLocation() {
				if(navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(function(position) {
						//var time = new Date().getTime();
						forecastUrl = forecastUrl + "latitude=" + position.coords.latitude + "&longitude=" + position.coords.longitude;
						getForecast(forecastUrl);
						
					});
				}
				else {
					console.log("Geolocation not supported");
				}
			}
			
			function getForecast(url) {
				d3.json(url, function(data) {
					var dataJson = JSON.parse(data);
					console.log(dataJson);
					
					//Check for alerts
					if (dataJson.alerts != undefined) {
						var alertDiv = document.getElementById("weather-alert");
						alertDiv.innerHTML += dataJson.alerts[0].title + " - ";
						alertDiv.innerHTML += dataJson.alerts[0].description;
						alertDiv.innerHTML += " - Check out more info here - " + dataJson[0].uri;
						
						alertDiv.style.display = "block";
					}
			
					var forecastElements = document.getElementsByClassName("forecast");
					
					for (var i = 0; i < forecastElements.length; i++) {
						forecastElements[i].style.display = "block";
					}
					
					var forecastHolder = document.getElementById("forecast-header");
					forecastHolder.innerHTML += " in " + dataJson.timezone;
					
					var forecastIcon = document.getElementById("forecast-icon");
					forecastIcon.className += " " +dataJson.currently.icon;
					
					
					//Define function to convert Fahrenheit to Celsius
					function F2C(tempf){ return (((parseInt(tempf)- 32)*5)/9 ).toFixed(2);}
					
					
					var forecastTempCelsius = document.getElementById("forecast-temperature-celsius");
					var temp = (((parseInt(dataJson.currently.temperature)- 32)*5)/9 ).toFixed(2);
					temperatureInCelsius = temp;
					forecastTempCelsius.innerHTML += "<b><span class='badge'>" + F2C(dataJson.currently.temperature) + "&degC</span></b>";
					
					var forecastTemp = document.getElementById("forecast-temperature");
					//forecastTemp.innerHTML += "<b><span class='badge'>" +dataJson.currently.temperature + "</span> Fahrenheit </b>";
					
					var forecastTempFeels = document.getElementById("forecast-temperature-feel");
					forecastTempFeels.innerHTML += "<b><span class='badge'>" + F2C(dataJson.currently.apparentTemperature) +  "&degC</span>";
					
					var forecastSummary = document.getElementById("forecast-temperature-summary");
					forecastSummary.innerHTML += dataJson.currently.summary;
					summary = dataJson.currently.summary.toLowerCase();
					//forecastSummary.className += dataJson.currently.icon;
					
					var forecastRain = document.getElementById("forecast-rain");
					//These values are referenced in the forecast documentation - 0.4 means heavy rain, 0.1 - moderate, etc.
					if (dataJson.currently.precipIntensity >= 0.4) {
						forecastRain.innerHTML += "<b>Heavy - " + dataJson.currently.precipIntensity + " in./hr. </b>";
					}
					else if (dataJson.currently.precipIntensity >= 0.1) {
						forecastRain.innerHTML += "<b>Moderate - " + dataJson.currently.precipIntensity + " in./hr. </b>";
					}
					else if (dataJson.currently.precipIntensity >= 0.017) {
						forecastRain.innerHTML += "<b>Light - " + dataJson.currently.precipIntensity + " in./hr. </b>";
					}
					else if (dataJson.currently.precipIntensity >= 0.002) {
						forecastRain.innerHTML += "<b>Very light - " + dataJson.currently.precipIntensity + " in./hr. </b>";
					}
					else {
						forecastRain.innerHTML += "<b>None - " + dataJson.currently.precipIntensity + " in./hr. </b>";
					}

					var forecastHumidity = document.getElementById("forecast-humidity");
					forecastHumidity.innerHTML += "<b>" + (dataJson.currently.humidity * 100) + " %  </b>";
					
					var forecastDew = document.getElementById("forecast-dew");
					forecastDew.innerHTML += "<b>"+dataJson.currently.dewPoint+"&degC</b>";
					
					var forecastWind = document.getElementById("forecast-wind");
					forecastWind += "<b>" +dataJson.currently.windSpeed + " mph  </b>";
					
					var forecastPressure = document.getElementById("forecast-pressure");
					forecastPressure.innerHTML +="<b>" +  dataJson.currently.pressure +  " hPa</b>";
					
					var forecastHourly = document.getElementById("forecast-hour");
					forecastHourly.innerHTML += "<b>" + dataJson.hourly.summary + " </b>";
					
					var forecastWeek = document.getElementById("forecast-week");
					forecastWeek.innerHTML += " <b>" + dataJson.daily.summary+ " </b>";
					
					getWarningPanel();
				});
			}
			
			function getWarningPanel(){
			
			//var isRaining = false;
			//var isSnowing = false;
			//var isVeryCold = false;
				var warningPanel1 = $("#warning-panel1");
				var warningPanel2 = $("#warning-panel2");
				var dangerPanel1 = $("#danger-panel1");
				var dangerPanel2 = $("#danger-panel2");
				var dangerPanel3 = $("#danger-panel3");
				var dangerPanel4 = $("#danger-panel4");
				
				if(temperatureInCelsius<0){
					dangerPanel1.removeClass("not-visible");
					
				}
				else if(temperatureInCelsius<10){
					warningPanel1.removeClass("not-visible");
					
				}
				else if(temperatureInCelsius>30){
					warningPanel2.removeClass("not-visible");
					
				}
				
				if(summary.indexOf("rain")>=0){
					dangerPanel2.removeClass("not-visible");
					
				}
				
				
			}
			
			getLocation();
			
		</script>

    </body>
</html>